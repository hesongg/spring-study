
### 스프링 핵심 원리 - 기본 

#### Reference) 
	* 스프링 핵심 원리 - 기본 (인프런 김영한님 강의 학습한 내용 정리)

#### 작성 코드
https://github.com/hesongg/inflearn-study


#### 빈 생명주기 콜백

- 데이터베이스 커넥션 풀이나, 네트워크 소켓처럼 애플리케이션 시작 시점에 필요한 연결을 미리 해두고,
	애플리케이션 종료 시점에 연결을 모두 종료하는 작업을 수행하려면 객체의 초기화와 종료 작업이 필요하다.
	
- 스프링의 초기화 작업과 종료 작업?

- 스프링 빈은 다음과 같은 라이프 사이클을 가진다.
	- 객체생성 -> 의존관계 주입
	
- 스프링 빈은 객체를 생성하고, 의존관계 주입이 다 끝난 다음에야 필요한 데이터를 사용할 수 있는 준비가 완료된다.

- 스프링 빈의 이벤트 라이프 사이클 (싱글톤에 대한 예시)
	- 스프링 컨테이너 생성 -> 스프링 빈 생성 -> 의존관계 주입 -> 초기화 콜백 -> 빈 사용 -> 소멸전 콜백 -> 스프링 종료

- 초기화 콜백 : 빈이 생성되고, 빈의 의존관계 주입이 완료된 후 호출

- 소멸전 콜백 : 빈이 소멸되기 직전에 호출


- 참고) 객체의 생성성과 초기화를 분리하자.
	- 생성자는 필수 정보(파라미터)를 받아 메모리를 할당해서 객체를 생성
	- 초기화는 이렇게 생성된 값들을 활용해서 외부 커넥션을 연결하는 등 무거운 동작 수행
	- 따라서 생성자안에서 무거운 초기화 작업을 같이 하는것 보다 명확하게 나누는 것이 유지보수 관점에서 좋다.
		- 물론 초기화 작업이 매우 간단하고 단순한 경우에는 생성자에서 한번에 처리하는 것이 좋을수도 잇다.


- 스프링은 크게 3가지 방법으로 빈 생명주기 콜백을 지원
	- 인터페이스
		- InitializingBean 인터페이스 상속
			- 스프링 컨테이너가 올라온 후, 의존관계 주입이 다 끝나면 afterPropertiesSet() 메서드를 호출해준다.
			
		- DisposableBean 인터페이스 상속
			- 빈이 종료될 때 호출된다.
			
		- 초기화, 소멸 인터페이스 단점
			- 스프링전용 인터페이스로서 해당 코드가 스프링 전용 인터페이스에 의존한다.
			- 초기화, 소멸 메서드의 이름 변경 불가
			- 내가 코드를 수정할 수 없는 외부라이브러리에 적용 불가함
		
		- 인터페이스를 사용하는 방법은 초기에 사용하던 방법으로, 요즘에는 거의 사용하지 않음
			
	- 설정 정보에 초기화 메서드, 종료 메서드 지정
		- @Bean 애노테이션 옵션 initMethod, destroyMethod 사용
			```java
			@Bean(initMethod = "init", destroyMethod = "close")
			```
			- 초기화 메서드를 init, 종료 메서드를 close로 사용함.
		
		- 메서드 이름 자유롭게 사용 가능
		
		- 스프링 빈이 스프링 코드에 의존하지 않음
		
		- 코드가 아니라 설정정보를 사용하기 때문에 코드를 고칠 수 없는 외부 라이브러리에도 초기화, 종료 메서드 적용 가능
		
		- @Bean으로 등록할때만 발생
		
		- destroyMethod 옵션의 특별한 기능
			- 라이브러리는 대부분 'close', 'shutdown' 이라는 이름의 종료 메서드 사용
			- @Bean의 destroyMethod 옵션의 기본 값은 '(inferred)' (추론)으로 등록되어 잇다.
			- 이 추론 기능은 'close', 'shutdown' 이라는 이름의 메서드를 자동으로 호출해준다. (추론 기능)
			
	
	- @PostConstruct, @PreDestroy 애노테이션 지원
		- 최신 스프링에서 가장 권장하는 방법
		- 초기화 메서드에 @PostConstruct 애노테이션에 사용, 종료 메서드에 @PreDestroy 애노테이션 사용
		- 해당 애노테이션은 자바 패키지에 존재하는 애노테이션이다. (스프링에 종속적인 기술이 아님 - 자바 표준)
		- 유일한 단점은 외부 라이브러리에는 적용 불가능함. 외부 라이브러리를 초기화, 종료해야하면 @Bean의 기능을 사용하면 된다.
